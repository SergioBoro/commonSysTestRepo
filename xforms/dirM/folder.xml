<?xml version="1.0" encoding="UTF-8"?><?xml-stylesheet href="xsltforms/xsltforms.xsl" type="text/xsl"?><html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:xsd="http://www.w3.org/2001/XMLschema" xmlns:fs="http://www.curs.ru/ns/FormServer" xmlns:xf="http://www.w3.org/2002/xforms">
	<head>
		<style type="text/css">
			body {
			    font-family: sans-serif;
			}
			div {
			    margin: 0px 0px 0px 0px;
			    padding: 0px;
			}
      td {
        vertical-align: top;
      }
			button.TabButton {
			    border: 0px;
			    background-color: transparent;
			    width: 100%;
			    height: 100%;
			}
      .orgtype .xforms-label {
        margin-top: 2px;      
        padding-left: 5px;
        font-size: 1em;
        float: left;
        width: 120px;
      }
      .orgtype .value {
        float: right;
        width: 260px;
      }
      .orgtype .xforms-value {
        margin: 0px;
        padding-left: 2px;
      }
      .baseTableInput .xforms-value {
          background-color: #ffffcc;
          border-bottom: 1px solid rgb(90, 139, 195); /*rgb(255,192,128);*/
          display: block;
          min-height: 17px;
          width: 100%;
          padding: 1px 0px 2px 2px;
      }
      div.baseTableInput2,
      .baseTableInput2 .xforms-value {
          background-color: #E5F2FF;
          border: 0 none;
          display: block;
          min-height: 21px;
          width: 100%;
          padding: 1px 0px 2px 2px;
      }
      .date .value .xforms-value {
         display: block !important;
         float: left !important;
         width: 215px !important;
         margin-right: 3px;
         padding: 0 !important;
      }
      .date .value .aid-button {
         width: 30px !important;
         height: 20px !important;
         display: block;
         float: left;
      }
			div.Hide {
			    display:
			    none;
			}
			div.Show {
			    display:
			    inline;
			}
			.aid-button, 
			.aid-button
			button {
        width: 30px !important;
        height: 20px !important;
      }
		</style>
		<xf:model id="xformId_mainModel">
			<xf:instance id="xformId_mainInstance" xmlns="">
				<schema >
					<folder>
            <id>0</id>
            <name></name>
            <parent_folder_id>1</parent_folder_id>
					</folder>
				</schema>
			</xf:instance>
      <xf:instance id="xformId_folder" xmlns="">
				<schema >
					<check>false</check>
				</schema>
			</xf:instance>

			<xf:bind>
        <!--xf:bind type="boolean" nodeset="instance('folder')/check" /!-->
        <xf:bind calculate="if((instance('xformId_mainInstance')/folder/name=''),'Отсутствует название папки!','')" nodeset="instance('xformId_mainInstance')/error_message"></xf:bind>
			</xf:bind>

      <xf:submission id="xformId_check_folder" method="post" instance="xformId_folder" replace="instance" ref="instance('xformId_mainInstance')" action="secured/sqlTransform?proc=ssp.struct_folder_check">
        <xf:action ev:event="xforms-submit-done">
          <!--xf:message>Сделано</xf:message!-->
          <xf:load resource="javascript:xforms.ready = false;xforms.refresh();xforms.ready = true;"></xf:load>
        </xf:action>
        <xf:action ev:event="xforms-submit-error">
          <xf:message>Ошибка при получении данных</xf:message>
        </xf:action>
      </xf:submission>
		</xf:model>
	</head>
	<body>
 	  <div style="width: 460px; float: left; clear: both;"> 
      <div class="group" style="width: 450px; height: 100px; float: left; clear: both; padding: 2px; margin: 0;">
        <div style="float: left; clear: both; margin-top: 5px;">
          <div class="cellHeader" style="height: 10px; width: 183px; float: left; clear: both; padding-right: 2px;">Название</div>
          <div class="cellHeader" style="height: 10px; width: 250px; float: left">Значение</div>
        </div>
        <div style="float: left; clear: both;">
          <table class="main2" cellspacing="1" cellpadding="0">
            <tr>
              <td style="width: 187px; font-weight: bold;">
                <div class="baseTableInput2">Название папки</div>
              </td>
              <td style="width: 252px; padding-left: 2px;">
                <xf:input class="baseTableInput" ref="instance('xformId_mainInstance')/folder/name"></xf:input>
              </td>
            </tr>
          </table>
          <table class="main2" cellspacing="1" cellpadding="0">
            <tr>
              <td style="width: 187px; font-weight: bold;">
                <div class="baseTableInput2">Родительская папка</div>
              </td>
              <td style="width: 252px; padding-left: 2px;">
                <xf:select1 class="baseTableInput" ref="instance('xformId_mainInstance')/folder/parent_folder_id">
                  <xf:itemset nodeset="instance('xformId_mainInstance')/folders/folder">
                    <xf:label ref="@name"></xf:label>
                    <xf:value ref="@id"></xf:value>
                  </xf:itemset>
                </xf:select1>
              </td>
            </tr>
          </table>
        </div>
      </div>
    </div>
		<div style="float: left; width: 460px; clear: both;">
      <div style="float: right; margin: 5px 0; padding: 0;">
        <div class="newbutton" style="width: 130px; margin: 0; padding-left: 10px; float: left;">
          <xf:trigger class="blue">
            <xf:label>ОК</xf:label>
            <xf:action ev:event="DOMActivate">
              <xf:action if="instance('xformId_mainInstance')/error_message!=''">
                <xf:message ref="instance('xformId_mainInstance')/error_message"></xf:message>
              </xf:action>
              <xf:action if="instance('xformId_mainInstance')/error_message=''">
                <xf:send submission="xformId_check_folder"></xf:send>
                <xf:action if="instance('xformId_folder')/check='true'">
                  <xf:load resource="javascript:gwtXFormSave('xformId','1',  Writer.toString(getSubformInstanceDocument('xformId_mainModel', 'xformId_mainInstance')))"></xf:load>
                </xf:action>
                <xf:action if="instance('xformId_folder')/check!='true'">
                  <xf:message ref="instance('xformId_folder')/check"></xf:message>
                </xf:action>
              </xf:action>
            </xf:action>
          </xf:trigger>
        </div>
        <div class="newbutton" style="width: 130px; margin: 0; padding-left: 10px; float: left;">
          <xf:trigger class="blue">
            <xf:label>Отмена</xf:label>
            <xf:action ev:event="DOMActivate">
              <xf:load resource="javascript:gwtXFormFilter('xformId','1', null)"></xf:load>
            </xf:action>
          </xf:trigger>
        </div>
      </div>
		</div>
	</body>
</html>