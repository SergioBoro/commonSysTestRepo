<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="xsltforms/xsltforms.xsl" type="text/xsl"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:xsd="http://www.w3.org/2001/XMLschema" xmlns:fs="http://www.curs.ru/ns/FormServer"
    xmlns:xf="http://www.w3.org/2002/xforms">
    <head>
      <style type="text/css">
        .aid-button,
        .aid-button
        button {
          width: 30px !important;
        }
        .dateInput .xforms-value {
          background-color: #E5F2FF;
          border: 0 none;
          margin: 6px 0 0 0;
          min-height: 13px;
          padding: 2px 0 0 0;
          width: 70px !important;
        }
        .controlTable button, .cell button {
          margin-top: 2px;
        }
      </style>
      <xf:model id="xformId_mainModel">
        <xf:instance id="xformId_mainInstance">
          <schema xmlns="">
            <context>
              <company id="" linksallow="0" linkid="0" type=""/>
              <ondate check="" value=""/>
            </context>
          </schema>
        </xf:instance>           
        <xf:instance id="quot">
          <schema xmlns=""> &quot; </schema>
        </xf:instance>			
        <xf:bind> 
          <!--<xf:bind nodeset="/schema/context/name" type="date"/>-->
          <xf:bind nodeset="instance('xformId_mainInstance')/context/ondate/@check" type="boolean"/>
          <xf:bind nodeset="instance('xformId_mainInstance')/context/ondate/@value" type="date"/>
          <xf:bind nodeset="instance('xformId_mainInstance')/context/ondate/company" readonly="true()"/>
		  <xf:bind nodeset="instance('xformId_mainInstance')/context/company/@type" readonly="true()"/>
        </xf:bind>
      </xf:model>
    </head>
    <body>
		<!--xf:output value="serialize(instance('xformId_mainInstance'))"/-->
      <div style="width: 250px; padding: 0px; float: left;">
        <xf:input class="baseInput" ref="instance('xformId_mainInstance')/context/company">
          <xf:label>Группа: </xf:label>
        </xf:input>
				<xf:input class="baseInput" ref="instance('xformId_mainInstance')/context/company/@type">
          <xf:label>Тип Группы: </xf:label>
				</xf:input>
      </div>
      <div class="newbutton" style="width: 30px; padding: 22px 2px 0px 0px; float: left;">
        <div class="blue" style="margin: 0;padding: 0;">
          <xf:selector 
		        buttonLabel       = "..."  
		        procListAndCount  = "'ctg.selector.selectors.groupSelector.celesta'"
		        generalFilters    = "''"
		        currentValue      = "''"
		        windowCaption     = "'Выберите группу'"
            xpathMapping      = "{'XPath(instance(quot(xformId_mainInstance))/context/company/@id)' : 'id', 'XPath(instance(quot(xformId_mainInstance))/context/company)' : 'name'
              ,'XPath(instance(quot(xformId_mainInstance))/context/company/@type)' : 'group_type', 'XPath(instance(quot(xformId_mainInstance))/context/company/@linksallow)' : 'allow_links'}"
          />
        </div>
      </div>
      <div class="newbutton" style="width: 30px; padding: 22px 0 0 0; margin: 0px; float: left;">
        <xf:trigger class="aid-button blue">
          <xf:label>X</xf:label>
          <xf:action ev:event="DOMActivate">
            <xf:setvalue ref="instance('xformId_mainInstance')/context/company/@id" value=""/>
            <xf:setvalue ref="instance('xformId_mainInstance')/context/company" value=""/>
            <xf:setvalue ref="instance('xformId_mainInstance')/context/company/@type" value=""/>
          </xf:action>
        </xf:trigger>
      </div>
      <div class="control" style="width: 20px; padding: 2px 2px 0px 2px; float: left;">
        <xf:input class="baseInput" ref="instance('xformId_mainInstance')/context/ondate/@check">
          <xf:label>Состав на дату:</xf:label>
        </xf:input>
      </div>
      <div class="newbutton" style="width: 110px; padding: 16px 6px 0px 0px; float: left;">
        <xf:input class="dateInput blue" ref="instance('xformId_mainInstance')/context/ondate/@value"/>
      </div>
      <xf:group ref="instance('xformId_mainInstance')/context/company[@linksallow=1]">      
        <div class="control" style="width: 250px; padding: 0px 6px 0px 0px; float: left;">
          <xf:select1 class="baseInput" ref="@linkid">
            <xf:label>Тип связи: </xf:label>
            <xf:itemset nodeset="instance('xformId_mainInstance')/links/link">
              <xf:label ref="@name"/>
              <xf:value ref="@id"/>
            </xf:itemset>					
          </xf:select1>
        </div>     
      </xf:group>
      <div class="newbutton" style="width: 130px; padding: 20px 2px 0 10px; float: left;">
        <xf:trigger class="blue">
          <xf:label>Отобразить</xf:label>
          <xf:action  if="instance('xformId_mainInstance')/context/company/@id>0" ev:event="DOMActivate">
            <!--xf:load resource="javascript:gwtXFormFilter('xformId','1',  Writer.toString(xforms.defaultModel.getInstanceDocument('xformId_mainInstance')))"/-->
			<xf:load resource="javascript:gwtXFormFilter('xformId','1', Writer.toString(getSubformInstanceDocument('xformId_mainModel', 'xformId_mainInstance')))"></xf:load>	  
          </xf:action>
        </xf:trigger>
      </div>
    </body>
</html>
